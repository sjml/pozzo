import{S as e,i as t,s as n,ad as l,z as s,A as i,b as o,h as a,u as r,J as c,F as u,K as d,v as f,j as p,ah as m,C as h,y as v,ai as g,a5 as $,c as w,m as x,t as k,a as y,d as U,e as b,g as C,f as L,Q as j,N as S,k as F,af as T,n as z,o as B,G as D,I as P,a4 as _,a2 as N,$ as A,l as I,M,aj as E,ak as R,al as V,a8 as Z}from"./main-582bc884.js";function G(e){let t,n;return{c(){t=s("img"),t.src!==(n=e[2])&&i(t,"src",n),i(t,"alt",e[3]),i(t,"class","svelte-42cape")},m(e,n){o(e,t,n)},p(e,l){4&l&&t.src!==(n=e[2])&&i(t,"src",n),8&l&&i(t,"alt",e[3])},d(e){e&&a(t)}}}function H(e){let t,n,p,m,h,v,g,$,w,x,k,y,U,b,C,L,j,S,F,T,z=e[0].file.name+"",B=l(e[0].file.size)+"",D=e[2]&&G(e);return{c(){t=s("div"),n=s("div"),p=s("div"),m=s("div"),h=s("span"),h.textContent="Name:",v=r(),g=c(z),$=r(),w=s("div"),x=s("span"),x.textContent="Size:",k=r(),y=c(B),U=r(),b=s("div"),D&&D.c(),C=r(),L=s("div"),j=s("progress"),S=r(),F=s("div"),T=c(e[5]),i(h,"class","label svelte-42cape"),i(m,"class","name"),i(x,"class","label svelte-42cape"),i(w,"class","size"),i(p,"class","meta svelte-42cape"),i(b,"class","preview svelte-42cape"),i(n,"class","info svelte-42cape"),i(j,"class","svelte-42cape"),i(F,"class","status svelte-42cape"),i(L,"class","status svelte-42cape"),i(t,"class","fileUploader svelte-42cape")},m(l,s){o(l,t,s),u(t,n),u(n,p),u(p,m),u(m,h),u(m,v),u(m,g),u(p,$),u(p,w),u(w,x),u(w,k),u(w,y),u(n,U),u(n,b),D&&D.m(b,null),u(t,C),u(t,L),u(L,j),e[7](j),u(L,S),u(L,F),u(F,T),e[8](t)},p(e,[t]){1&t&&z!==(z=e[0].file.name+"")&&d(g,z),1&t&&B!==(B=l(e[0].file.size)+"")&&d(y,B),e[2]?D?D.p(e,t):(D=G(e),D.c(),D.m(b,null)):D&&(D.d(1),D=null),32&t&&d(T,e[5])},i:f,o:f,d(n){n&&a(t),D&&D.d(),e[7](null),e[8](null)}}}function J(e,t,n){let l;p(e,m,(e=>n(9,l=e)));var s=this&&this.__awaiter||function(e,t,n,l){return new(n||(n=Promise))((function(s,i){function o(e){try{r(l.next(e))}catch(e){i(e)}}function a(e){try{r(l.throw(e))}catch(e){i(e)}}function r(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}r((l=l.apply(e,t||[])).next())}))};const i=h();let o,a,{uploadStatus:r}=t,c=null,u="";v((()=>{if(n(0,r.startUploadCallback=()=>f(),r),n(1,o.value=0,o),r.file.type.startsWith("image")){const e=new FileReader;e.readAsDataURL(r.file),e.onloadend=()=>{n(2,c=e.result),n(3,u=r.file.name)}}}));let d="Pending…";function f(){return s(this,void 0,void 0,(function*(){if(r.status>0)return;n(0,r.status=1,r),n(5,d="Uploading…"),l||a.scrollIntoView({behavior:"smooth",block:"center"});const e=yield g(r,(e=>n(1,o.value=e,o)),(e=>{n(5,d="Processing…"),o.removeAttribute("value")}));n(1,o.value=1,o),e.success?(n(5,d="Done!"),n(0,r.status=2,r),i("fileUploadDone")):(n(5,d="Failed :("),n(0,r.status=3,r),i("fileUploadFailed"))}))}return e.$$set=e=>{"uploadStatus"in e&&n(0,r=e.uploadStatus)},e.$$.update=()=>{3&e.$$.dirty&&o&&0==r.status&&n(1,o.value=0,o)},[r,o,c,u,a,d,f,function(e){$[e?"unshift":"push"]((()=>{o=e,n(1,o),n(0,r)}))},function(e){$[e?"unshift":"push"]((()=>{a=e,n(4,a)}))}]}class K extends e{constructor(e){super(),t(this,e,J,H,n,{uploadStatus:0,startUpload:6})}get startUpload(){return this.$$.ctx[6]}}function O(e,t,n){const l=e.slice();return l[18]=t[n],l}function Q(e){let t,n,l,c,d,f,p;function m(e,t){return e[2]>0?q:W}let h=m(e),v=h(e);return c=new D({props:{title:"Upload",isBig:!0,margin:"0 30px",$$slots:{default:[X]},$$scope:{ctx:e}}}),c.$on("click",e[8]),f=new D({props:{title:"Cancel",isBig:!0,margin:"0 30px",$$slots:{default:[Y]},$$scope:{ctx:e}}}),f.$on("click",e[9]),{c(){t=s("div"),v.c(),n=r(),l=s("div"),w(c.$$.fragment),d=r(),w(f.$$.fragment),i(l,"class","yesno svelte-hxbnie"),i(t,"class","confirm svelte-hxbnie")},m(e,s){o(e,t,s),v.m(t,null),u(t,n),u(t,l),x(c,l,null),u(l,d),x(f,l,null),p=!0},p(e,l){h===(h=m(e))&&v?v.p(e,l):(v.d(1),v=h(e),v&&(v.c(),v.m(t,n)));const s={};2097152&l&&(s.$$scope={dirty:l,ctx:e}),c.$set(s);const i={};2097152&l&&(i.$$scope={dirty:l,ctx:e}),f.$set(i)},i(e){p||(k(c.$$.fragment,e),k(f.$$.fragment,e),p=!0)},o(e){y(c.$$.fragment,e),y(f.$$.fragment,e),p=!1},d(e){e&&a(t),v.d(),U(c),U(f)}}}function W(e){let t,n,l,s,i,r=e[0].length+"",u=1==e[0].length?"":"s";return{c(){t=c("Upload "),n=c(r),l=c(" image"),s=c(u),i=c("?")},m(e,a){o(e,t,a),o(e,n,a),o(e,l,a),o(e,s,a),o(e,i,a)},p(e,t){1&t&&r!==(r=e[0].length+"")&&d(n,r),1&t&&u!==(u=1==e[0].length?"":"s")&&d(s,u)},d(e){e&&a(t),e&&a(n),e&&a(l),e&&a(s),e&&a(i)}}}function q(e){let t,n,l=1==e[2]?"This image ":"These images ";return{c(){t=c(l),n=c("did not upload\n                successfully. Do you want to try again?")},m(e,l){o(e,t,l),o(e,n,l)},p(e,n){4&n&&l!==(l=1==e[2]?"This image ":"These images ")&&d(t,l)},d(e){e&&a(t),e&&a(n)}}}function X(e){let t,n,l,s,r,d;return{c(){t=P("svg"),n=P("rect"),l=P("circle"),s=P("polyline"),r=P("line"),d=c("\n                    Upload"),i(n,"width","256"),i(n,"height","256"),i(n,"fill","none"),i(l,"cx","128"),i(l,"cy","128"),i(l,"r","96"),i(l,"fill","none"),i(l,"stroke","currentColor"),i(l,"stroke-linecap","round"),i(l,"stroke-linejoin","round"),i(l,"stroke-width","24"),i(s,"points","94.059 121.941 128 88 161.941 121.941"),i(s,"fill","none"),i(s,"stroke","currentColor"),i(s,"stroke-linecap","round"),i(s,"stroke-linejoin","round"),i(s,"stroke-width","24"),i(r,"x1","128"),i(r,"y1","168"),i(r,"x2","128"),i(r,"y2","88"),i(r,"fill","none"),i(r,"stroke","currentColor"),i(r,"stroke-linecap","round"),i(r,"stroke-linejoin","round"),i(r,"stroke-width","24"),i(t,"xmlns","http://www.w3.org/2000/svg"),i(t,"fill","currentColor"),i(t,"viewBox","0 0 256 256")},m(e,i){o(e,t,i),u(t,n),u(t,l),u(t,s),u(t,r),o(e,d,i)},d(e){e&&a(t),e&&a(d)}}}function Y(e){let t,n,l,s,r,d;return{c(){t=P("svg"),n=P("rect"),l=P("circle"),s=P("line"),r=P("line"),d=c("\n                    Cancel"),i(n,"width","256"),i(n,"height","256"),i(n,"fill","none"),i(l,"cx","128"),i(l,"cy","128"),i(l,"r","96"),i(l,"fill","none"),i(l,"stroke","currentColor"),i(l,"stroke-linecap","round"),i(l,"stroke-linejoin","round"),i(l,"stroke-width","24"),i(s,"x1","160"),i(s,"y1","96"),i(s,"x2","96"),i(s,"y2","160"),i(s,"fill","none"),i(s,"stroke","currentColor"),i(s,"stroke-linecap","round"),i(s,"stroke-linejoin","round"),i(s,"stroke-width","24"),i(r,"x1","160"),i(r,"y1","160"),i(r,"x2","96"),i(r,"y2","96"),i(r,"fill","none"),i(r,"stroke","currentColor"),i(r,"stroke-linecap","round"),i(r,"stroke-linejoin","round"),i(r,"stroke-width","24"),i(t,"xmlns","http://www.w3.org/2000/svg"),i(t,"fill","currentColor"),i(t,"viewBox","0 0 256 256")},m(e,i){o(e,t,i),u(t,n),u(t,l),u(t,s),u(t,r),o(e,d,i)},d(e){e&&a(t),e&&a(d)}}}function ee(e){let t,n,l=e[1],s=[];for(let t=0;t<l.length;t+=1)s[t]=te(O(e,l,t));const i=e=>y(s[e],1,1,(()=>{s[e]=null}));return{c(){for(let e=0;e<s.length;e+=1)s[e].c();t=b()},m(e,l){for(let t=0;t<s.length;t+=1)s[t].m(e,l);o(e,t,l),n=!0},p(e,n){if(194&n){let o;for(l=e[1],o=0;o<l.length;o+=1){const i=O(e,l,o);s[o]?(s[o].p(i,n),k(s[o],1)):(s[o]=te(i),s[o].c(),k(s[o],1),s[o].m(t.parentNode,t))}for(C(),o=l.length;o<s.length;o+=1)i(o);L()}},i(e){if(!n){for(let e=0;e<l.length;e+=1)k(s[e]);n=!0}},o(e){s=s.filter(Boolean);for(let e=0;e<s.length;e+=1)y(s[e]);n=!1},d(e){j(s,e),e&&a(t)}}}function te(e){let t,n;return t=new K({props:{uploadStatus:e[18]}}),t.$on("fileUploadDone",e[6]),t.$on("fileUploadFailed",e[7]),{c(){w(t.$$.fragment)},m(e,l){x(t,e,l),n=!0},p(e,n){const l={};2&n&&(l.uploadStatus=e[18]),t.$set(l)},i(e){n||(k(t.$$.fragment,e),n=!0)},o(e){y(t.$$.fragment,e),n=!1},d(e){U(t,e)}}}function ne(e){let t,n,l,c,d,f=e[3]&&Q(e),p=e[1]&&ee(e);return{c(){t=s("div"),f&&f.c(),n=r(),p&&p.c(),i(t,"class","fileUploadList svelte-hxbnie")},m(s,i){o(s,t,i),f&&f.m(t,null),u(t,n),p&&p.m(t,null),l=!0,c||(d=S(t,"click",e[10]),c=!0)},p(e,[l]){e[3]?f?(f.p(e,l),8&l&&k(f,1)):(f=Q(e),f.c(),k(f,1),f.m(t,n)):f&&(C(),y(f,1,1,(()=>{f=null})),L()),e[1]?p?(p.p(e,l),2&l&&k(p,1)):(p=ee(e),p.c(),k(p,1),p.m(t,null)):p&&(C(),y(p,1,1,(()=>{p=null})),L())},i(e){l||(k(f),k(p),l=!0)},o(e){y(f),y(p),l=!1},d(e){e&&a(t),f&&f.d(),p&&p.d(),c=!1,d()}}}function le(e){return e.preventDefault(),e.returnValue="","..."}function se(e,t,n){let l,s,i;p(e,m,(e=>n(4,l=e))),p(e,F,(e=>n(13,s=e))),p(e,T,(e=>n(14,i=e)));var o=this&&this.__awaiter||function(e,t,n,l){return new(n||(n=Promise))((function(s,i){function o(e){try{r(l.next(e))}catch(e){i(e)}}function a(e){try{r(l.throw(e))}catch(e){i(e)}}function r(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}r((l=l.apply(e,t||[])).next())}))};const a=h();let r,{fileList:c}=t;v((()=>{z(m,l=!1,l);let e=null,t=1;if(null!=s){e=s.id;const n=s.photos.map((e=>e.ordering));t=0==n.length?1:Math.max(...n)+1}n(1,r=c.map(((n,l)=>({file:n,status:0,index:l+t,targetAlbum:e}))))})),B((()=>{window.removeEventListener("beforeunload",le)}));let u=0,d=0;function f(){for(;d<i.simultaneousUploads&&!(u>=r.length);)r[u].startUploadCallback(),u+=1,d+=1}function g(){d-=1,0==d&&u>=r.length?function(){if(0==$)return void a("finished");n(1,r=r.filter((e=>3==e.status))),n(3,w=!0)}():f()}let $=0;let w=!0;return e.$$set=e=>{"fileList"in e&&n(0,c=e.fileList)},[c,r,$,w,l,a,g,function(){n(2,$+=1),g()},function(){return o(this,void 0,void 0,(function*(){window.addEventListener("beforeunload",le),n(2,$=0),u=0,d=0,n(3,w=!1);for(let e=0;e<r.length;e++)n(1,r[e].status=0,r);yield _(),yield new Promise((e=>setTimeout(e,400))),z(m,l=!1,l),f()}))},()=>a("dismissed"),()=>z(m,l=!0,l)]}class ie extends e{constructor(e){super(),t(this,e,se,ne,n,{fileList:0})}}function oe(e){let t,n,l,s;const i=[re,ae],r=[];function c(e,t){return e[0]?0:1}return t=c(e),n=r[t]=i[t](e),{c(){n.c(),l=b()},m(e,n){r[t].m(e,n),o(e,l,n),s=!0},p(e,s){let o=t;t=c(e),t===o?r[t].p(e,s):(C(),y(r[o],1,1,(()=>{r[o]=null})),L(),n=r[t],n?n.p(e,s):(n=r[t]=i[t](e),n.c()),k(n,1),n.m(l.parentNode,l))},i(e){s||(k(n),s=!0)},o(e){y(n),s=!1},d(e){r[t].d(e),e&&a(l)}}}function ae(e){let t,n,l,r,c;return{c(){t=s("div"),n=s("div"),n.innerHTML='<div class="dragIndicatorOutline svelte-i5ms3h"></div>',i(n,"class","dragIndicator svelte-i5ms3h"),i(t,"class","uploadZone svelte-i5ms3h")},m(e,l){o(e,t,l),u(t,n),c=!0},p:f,i(e){c||(M((()=>{r&&r.end(1),l||(l=E(n,Z,{duration:100})),l.start()})),c=!0)},o(e){l&&l.invalidate(),r=R(n,Z,{duration:200}),c=!1},d(e){e&&a(t),e&&r&&r.end()}}}function re(e){let t,n,l;return n=new ie({props:{fileList:e[0]}}),n.$on("finished",e[4]),n.$on("dismissed",e[5]),{c(){t=s("div"),w(n.$$.fragment),i(t,"class","uploadZone svelte-i5ms3h")},m(e,s){o(e,t,s),x(n,t,null),l=!0},p(e,t){const l={};1&t&&(l.fileList=e[0]),n.$set(l)},i(e){l||(k(n.$$.fragment,e),l=!0)},o(e){y(n.$$.fragment,e),l=!1},d(e){e&&a(t),U(n)}}}function ce(e){let t,n,l,s,i=(e[1]>0||null!=e[0])&&e[2]&&oe(e);return{c(){i&&i.c(),t=b()},m(a,r){i&&i.m(a,r),o(a,t,r),n=!0,l||(s=[S(window,"dragover",N(e[6])),S(window,"dragenter",N(e[7])),S(window,"dragleave",N(e[8])),S(window,"drop",N(e[3]))],l=!0)},p(e,[n]){(e[1]>0||null!=e[0])&&e[2]?i?(i.p(e,n),7&n&&k(i,1)):(i=oe(e),i.c(),k(i,1),i.m(t.parentNode,t)):i&&(C(),y(i,1,1,(()=>{i=null})),L())},i(e){n||(k(i),n=!0)},o(e){y(i),n=!1},d(e){i&&i.d(e),e&&a(t),l=!1,A(s)}}}function ue(e,t,n){let l,s;p(e,T,(e=>n(9,l=e))),p(e,I,(e=>n(2,s=e)));var i=this&&this.__awaiter||function(e,t,n,l){return new(n||(n=Promise))((function(s,i){function o(e){try{r(l.next(e))}catch(e){i(e)}}function a(e){try{r(l.throw(e))}catch(e){i(e)}}function r(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}r((l=l.apply(e,t||[])).next())}))};let o;const a=h();let r=0;function c(e){return!!l.formats.includes(e.type)&&!(e.size>l.maxUploadBytes)}return[o,r,s,function(e){return i(this,void 0,void 0,(function*(){n(1,r=0);let t=[...e.dataTransfer.files];t=t.filter(c),0!=t.length&&n(0,o=t)}))},function(){a("done",{numFiles:o.length}),n(0,o=null)},function(){n(0,o=null),a("done",{numFiles:0})},function(t){V(e,t)},()=>n(1,++r),()=>n(1,--r)]}export default class extends e{constructor(e){super(),t(this,e,ue,ce,n,{})}}
