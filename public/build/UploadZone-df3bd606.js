import{S as t,i as e,s as n,ad as s,y as l,z as o,b as i,h as a,w as r,U as c,B as u,V as d,x as f,j as p,aj as m,F as h,a7 as v,ak as g,a9 as $,c as w,m as x,t as y,a as k,d as U,e as b,g as C,f as L,N as j,M as S,l as B,o as D,q as F,A as T,p as z,H as P,I as _,a8 as A,a5 as N,a2 as I,n as M,D as V,al as E,am as G,J as H,ac as R}from"./main-007fa5d6.js";function Z(t){let e,n;return{c(){e=l("img"),e.src!==(n=t[2])&&o(e,"src",n),o(e,"alt",t[3]),o(e,"class","svelte-42cape")},m(t,n){i(t,e,n)},p(t,s){4&s&&e.src!==(n=t[2])&&o(e,"src",n),8&s&&o(e,"alt",t[3])},d(t){t&&a(e)}}}function q(t){let e,n,p,m,h,v,g,$,w,x,y,k,U,b,C,L,j,S,B,D,F=t[0].file.name+"",T=s(t[0].file.size)+"",z=t[2]&&Z(t);return{c(){e=l("div"),n=l("div"),p=l("div"),m=l("div"),h=l("span"),h.textContent="Name:",v=r(),g=c(F),$=r(),w=l("div"),x=l("span"),x.textContent="Size:",y=r(),k=c(T),U=r(),b=l("div"),z&&z.c(),C=r(),L=l("div"),j=l("progress"),S=r(),B=l("div"),D=c(t[5]),o(h,"class","label svelte-42cape"),o(m,"class","name"),o(x,"class","label svelte-42cape"),o(w,"class","size"),o(p,"class","meta svelte-42cape"),o(b,"class","preview svelte-42cape"),o(n,"class","info svelte-42cape"),o(j,"class","svelte-42cape"),o(B,"class","status svelte-42cape"),o(L,"class","status svelte-42cape"),o(e,"class","fileUploader svelte-42cape")},m(s,l){i(s,e,l),u(e,n),u(n,p),u(p,m),u(m,h),u(m,v),u(m,g),u(p,$),u(p,w),u(w,x),u(w,y),u(w,k),u(n,U),u(n,b),z&&z.m(b,null),u(e,C),u(e,L),u(L,j),t[7](j),u(L,S),u(L,B),u(B,D),t[8](e)},p(t,[e]){1&e&&F!==(F=t[0].file.name+"")&&d(g,F),1&e&&T!==(T=s(t[0].file.size)+"")&&d(k,T),t[2]?z?z.p(t,e):(z=Z(t),z.c(),z.m(b,null)):z&&(z.d(1),z=null),32&e&&d(D,t[5])},i:f,o:f,d(n){n&&a(e),z&&z.d(),t[7](null),t[8](null)}}}function J(t,e,n){let s;p(t,m,(t=>n(9,s=t)));var l=this&&this.__awaiter||function(t,e,n,s){return new(n||(n=Promise))((function(l,o){function i(t){try{r(s.next(t))}catch(t){o(t)}}function a(t){try{r(s.throw(t))}catch(t){o(t)}}function r(t){var e;t.done?l(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(i,a)}r((s=s.apply(t,e||[])).next())}))};const o=h();let i,a,{uploadStatus:r}=e,c=null,u="";v((()=>{if(n(0,r.startUploadCallback=()=>f(),r),n(1,i.value=0,i),r.file.type.startsWith("image")){const t=new FileReader;t.readAsDataURL(r.file),t.onloadend=()=>{n(2,c=t.result),n(3,u=r.file.name)}}}));let d="Pending…";function f(){return l(this,void 0,void 0,(function*(){if(r.status>0)return;n(0,r.status=1,r),n(5,d="Uploading…"),s||a.scrollIntoView({behavior:"smooth",block:"center"});const t=yield g(r,(t=>n(1,i.value=t,i)),(t=>{n(5,d="Processing…"),i.removeAttribute("value")}));n(1,i.value=1,i),t.success?(n(5,d="Done!"),n(0,r.status=2,r),o("fileUploadDone")):(n(5,d="Failed :("),n(0,r.status=3,r),o("fileUploadFailed"))}))}return t.$$set=t=>{"uploadStatus"in t&&n(0,r=t.uploadStatus)},t.$$.update=()=>{3&t.$$.dirty&&i&&0==r.status&&n(1,i.value=0,i)},[r,i,c,u,a,d,f,function(t){$[t?"unshift":"push"]((()=>{i=t,n(1,i),n(0,r)}))},function(t){$[t?"unshift":"push"]((()=>{a=t,n(4,a)}))}]}class O extends t{constructor(t){super(),e(this,t,J,q,n,{uploadStatus:0,startUpload:6})}get startUpload(){return this.$$.ctx[6]}}function W(t,e,n){const s=t.slice();return s[18]=e[n],s}function K(t){let e,n,s,c,d,f,p;function m(t,e){return t[2]>0?X:Q}let h=m(t),v=h(t);return c=new P({props:{title:"Upload",isBig:!0,margin:"0 30px",$$slots:{default:[Y]},$$scope:{ctx:t}}}),c.$on("click",t[8]),f=new P({props:{title:"Cancel",isBig:!0,margin:"0 30px",$$slots:{default:[tt]},$$scope:{ctx:t}}}),f.$on("click",t[9]),{c(){e=l("div"),v.c(),n=r(),s=l("div"),w(c.$$.fragment),d=r(),w(f.$$.fragment),o(s,"class","yesno svelte-hxbnie"),o(e,"class","confirm svelte-hxbnie")},m(t,l){i(t,e,l),v.m(e,null),u(e,n),u(e,s),x(c,s,null),u(s,d),x(f,s,null),p=!0},p(t,s){h===(h=m(t))&&v?v.p(t,s):(v.d(1),v=h(t),v&&(v.c(),v.m(e,n)));const l={};2097152&s&&(l.$$scope={dirty:s,ctx:t}),c.$set(l);const o={};2097152&s&&(o.$$scope={dirty:s,ctx:t}),f.$set(o)},i(t){p||(y(c.$$.fragment,t),y(f.$$.fragment,t),p=!0)},o(t){k(c.$$.fragment,t),k(f.$$.fragment,t),p=!1},d(t){t&&a(e),v.d(),U(c),U(f)}}}function Q(t){let e,n,s,l,o,r=t[0].length+"",u=1==t[0].length?"":"s";return{c(){e=c("Upload "),n=c(r),s=c(" image"),l=c(u),o=c("?")},m(t,a){i(t,e,a),i(t,n,a),i(t,s,a),i(t,l,a),i(t,o,a)},p(t,e){1&e&&r!==(r=t[0].length+"")&&d(n,r),1&e&&u!==(u=1==t[0].length?"":"s")&&d(l,u)},d(t){t&&a(e),t&&a(n),t&&a(s),t&&a(l),t&&a(o)}}}function X(t){let e,n,s=1==t[2]?"This image ":"These images ";return{c(){e=c(s),n=c("did not upload\n                successfully. Do you want to try again?")},m(t,s){i(t,e,s),i(t,n,s)},p(t,n){4&n&&s!==(s=1==t[2]?"This image ":"These images ")&&d(e,s)},d(t){t&&a(e),t&&a(n)}}}function Y(t){let e,n,s,l,r,d;return{c(){e=_("svg"),n=_("rect"),s=_("circle"),l=_("polyline"),r=_("line"),d=c("\n                    Upload"),o(n,"width","256"),o(n,"height","256"),o(n,"fill","none"),o(s,"cx","128"),o(s,"cy","128"),o(s,"r","96"),o(s,"fill","none"),o(s,"stroke","currentColor"),o(s,"stroke-linecap","round"),o(s,"stroke-linejoin","round"),o(s,"stroke-width","24"),o(l,"points","94.059 121.941 128 88 161.941 121.941"),o(l,"fill","none"),o(l,"stroke","currentColor"),o(l,"stroke-linecap","round"),o(l,"stroke-linejoin","round"),o(l,"stroke-width","24"),o(r,"x1","128"),o(r,"y1","168"),o(r,"x2","128"),o(r,"y2","88"),o(r,"fill","none"),o(r,"stroke","currentColor"),o(r,"stroke-linecap","round"),o(r,"stroke-linejoin","round"),o(r,"stroke-width","24"),o(e,"xmlns","http://www.w3.org/2000/svg"),o(e,"fill","currentColor"),o(e,"viewBox","0 0 256 256")},m(t,o){i(t,e,o),u(e,n),u(e,s),u(e,l),u(e,r),i(t,d,o)},d(t){t&&a(e),t&&a(d)}}}function tt(t){let e,n,s,l,r,d;return{c(){e=_("svg"),n=_("rect"),s=_("circle"),l=_("line"),r=_("line"),d=c("\n                    Cancel"),o(n,"width","256"),o(n,"height","256"),o(n,"fill","none"),o(s,"cx","128"),o(s,"cy","128"),o(s,"r","96"),o(s,"fill","none"),o(s,"stroke","currentColor"),o(s,"stroke-linecap","round"),o(s,"stroke-linejoin","round"),o(s,"stroke-width","24"),o(l,"x1","160"),o(l,"y1","96"),o(l,"x2","96"),o(l,"y2","160"),o(l,"fill","none"),o(l,"stroke","currentColor"),o(l,"stroke-linecap","round"),o(l,"stroke-linejoin","round"),o(l,"stroke-width","24"),o(r,"x1","160"),o(r,"y1","160"),o(r,"x2","96"),o(r,"y2","96"),o(r,"fill","none"),o(r,"stroke","currentColor"),o(r,"stroke-linecap","round"),o(r,"stroke-linejoin","round"),o(r,"stroke-width","24"),o(e,"xmlns","http://www.w3.org/2000/svg"),o(e,"fill","currentColor"),o(e,"viewBox","0 0 256 256")},m(t,o){i(t,e,o),u(e,n),u(e,s),u(e,l),u(e,r),i(t,d,o)},d(t){t&&a(e),t&&a(d)}}}function et(t){let e,n,s=t[1],l=[];for(let e=0;e<s.length;e+=1)l[e]=nt(W(t,s,e));const o=t=>k(l[t],1,1,(()=>{l[t]=null}));return{c(){for(let t=0;t<l.length;t+=1)l[t].c();e=b()},m(t,s){for(let e=0;e<l.length;e+=1)l[e].m(t,s);i(t,e,s),n=!0},p(t,n){if(194&n){let i;for(s=t[1],i=0;i<s.length;i+=1){const o=W(t,s,i);l[i]?(l[i].p(o,n),y(l[i],1)):(l[i]=nt(o),l[i].c(),y(l[i],1),l[i].m(e.parentNode,e))}for(C(),i=s.length;i<l.length;i+=1)o(i);L()}},i(t){if(!n){for(let t=0;t<s.length;t+=1)y(l[t]);n=!0}},o(t){l=l.filter(Boolean);for(let t=0;t<l.length;t+=1)k(l[t]);n=!1},d(t){j(l,t),t&&a(e)}}}function nt(t){let e,n;return e=new O({props:{uploadStatus:t[18]}}),e.$on("fileUploadDone",t[6]),e.$on("fileUploadFailed",t[7]),{c(){w(e.$$.fragment)},m(t,s){x(e,t,s),n=!0},p(t,n){const s={};2&n&&(s.uploadStatus=t[18]),e.$set(s)},i(t){n||(y(e.$$.fragment,t),n=!0)},o(t){k(e.$$.fragment,t),n=!1},d(t){U(e,t)}}}function st(t){let e,n,s,c,d,f=t[3]&&K(t),p=t[1]&&et(t);return{c(){e=l("div"),f&&f.c(),n=r(),p&&p.c(),o(e,"class","fileUploadList svelte-hxbnie")},m(l,o){i(l,e,o),f&&f.m(e,null),u(e,n),p&&p.m(e,null),s=!0,c||(d=S(e,"click",t[10]),c=!0)},p(t,[s]){t[3]?f?(f.p(t,s),8&s&&y(f,1)):(f=K(t),f.c(),y(f,1),f.m(e,n)):f&&(C(),k(f,1,1,(()=>{f=null})),L()),t[1]?p?(p.p(t,s),2&s&&y(p,1)):(p=et(t),p.c(),y(p,1),p.m(e,null)):p&&(C(),k(p,1,1,(()=>{p=null})),L())},i(t){s||(y(f),y(p),s=!0)},o(t){k(f),k(p),s=!1},d(t){t&&a(e),f&&f.d(),p&&p.d(),c=!1,d()}}}function lt(t){return t.preventDefault(),t.returnValue="","..."}function ot(t,e,n){let s,l,o;p(t,m,(t=>n(4,s=t))),p(t,B,(t=>n(13,l=t))),p(t,D,(t=>n(14,o=t)));var i=this&&this.__awaiter||function(t,e,n,s){return new(n||(n=Promise))((function(l,o){function i(t){try{r(s.next(t))}catch(t){o(t)}}function a(t){try{r(s.throw(t))}catch(t){o(t)}}function r(t){var e;t.done?l(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(i,a)}r((s=s.apply(t,e||[])).next())}))};const a=h();let r,{fileList:c}=e;v((()=>{F(m,s=!1,s);let t=null,e=1;if(null!=l&&l.type==T.Album){t=l.id;const n=l.photoGroups[l.photoGroups.length-1].photos.map((t=>t.ordering));e=0==n.length?1:Math.max(...n)+1}n(1,r=c.map(((n,s)=>({file:n,status:0,index:s+e,targetAlbum:t}))))})),z((()=>{window.removeEventListener("beforeunload",lt)}));let u=0,d=0;function f(){for(;d<o.simultaneousUploads&&!(u>=r.length);)r[u].startUploadCallback(),u+=1,d+=1}function g(){d-=1,0==d&&u>=r.length?function(){if(0==$)return void a("finished");n(1,r=r.filter((t=>3==t.status))),n(3,w=!0)}():f()}let $=0;let w=!0;return t.$$set=t=>{"fileList"in t&&n(0,c=t.fileList)},[c,r,$,w,s,a,g,function(){n(2,$+=1),g()},function(){return i(this,void 0,void 0,(function*(){window.addEventListener("beforeunload",lt),n(2,$=0),u=0,d=0,n(3,w=!1);for(let t=0;t<r.length;t++)n(1,r[t].status=0,r);yield A(),yield new Promise((t=>setTimeout(t,400))),F(m,s=!1,s),f()}))},()=>a("dismissed"),()=>F(m,s=!0,s)]}class it extends t{constructor(t){super(),e(this,t,ot,st,n,{fileList:0})}}function at(t){let e,n,s,l;const o=[ct,rt],r=[];function c(t,e){return t[0]?0:1}return e=c(t),n=r[e]=o[e](t),{c(){n.c(),s=b()},m(t,n){r[e].m(t,n),i(t,s,n),l=!0},p(t,l){let i=e;e=c(t),e===i?r[e].p(t,l):(C(),k(r[i],1,1,(()=>{r[i]=null})),L(),n=r[e],n?n.p(t,l):(n=r[e]=o[e](t),n.c()),y(n,1),n.m(s.parentNode,s))},i(t){l||(y(n),l=!0)},o(t){k(n),l=!1},d(t){r[e].d(t),t&&a(s)}}}function rt(t){let e,n,s,r,c;return{c(){e=l("div"),n=l("div"),n.innerHTML='<div class="dragIndicatorOutline svelte-i5ms3h"></div>',o(n,"class","dragIndicator svelte-i5ms3h"),o(e,"class","uploadZone svelte-i5ms3h")},m(t,s){i(t,e,s),u(e,n),c=!0},p:f,i(t){c||(V((()=>{r&&r.end(1),s||(s=E(n,R,{duration:100})),s.start()})),c=!0)},o(t){s&&s.invalidate(),r=G(n,R,{duration:200}),c=!1},d(t){t&&a(e),t&&r&&r.end()}}}function ct(t){let e,n,s;return n=new it({props:{fileList:t[0]}}),n.$on("finished",t[4]),n.$on("dismissed",t[5]),{c(){e=l("div"),w(n.$$.fragment),o(e,"class","uploadZone svelte-i5ms3h")},m(t,l){i(t,e,l),x(n,e,null),s=!0},p(t,e){const s={};1&e&&(s.fileList=t[0]),n.$set(s)},i(t){s||(y(n.$$.fragment,t),s=!0)},o(t){k(n.$$.fragment,t),s=!1},d(t){t&&a(e),U(n)}}}function ut(t){let e,n,s,l,o=(t[1]>0||null!=t[0])&&t[2]&&at(t);return{c(){o&&o.c(),e=b()},m(a,r){o&&o.m(a,r),i(a,e,r),n=!0,s||(l=[S(window,"dragover",N(t[6])),S(window,"dragenter",N(t[7])),S(window,"dragleave",N(t[8])),S(window,"drop",N(t[3]))],s=!0)},p(t,[n]){(t[1]>0||null!=t[0])&&t[2]?o?(o.p(t,n),7&n&&y(o,1)):(o=at(t),o.c(),y(o,1),o.m(e.parentNode,e)):o&&(C(),k(o,1,1,(()=>{o=null})),L())},i(t){n||(y(o),n=!0)},o(t){k(o),n=!1},d(t){o&&o.d(t),t&&a(e),s=!1,I(l)}}}function dt(t,e,n){let s,l;p(t,D,(t=>n(9,s=t))),p(t,M,(t=>n(2,l=t)));var o=this&&this.__awaiter||function(t,e,n,s){return new(n||(n=Promise))((function(l,o){function i(t){try{r(s.next(t))}catch(t){o(t)}}function a(t){try{r(s.throw(t))}catch(t){o(t)}}function r(t){var e;t.done?l(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(i,a)}r((s=s.apply(t,e||[])).next())}))};let i;const a=h();let r=0;function c(t){return!!s.formats.includes(t.type)&&!(t.size>s.maxUploadBytes)}return[i,r,l,function(t){return o(this,void 0,void 0,(function*(){n(1,r=0);let e=[...t.dataTransfer.files];e=e.filter(c),0!=e.length&&n(0,i=e)}))},function(){a("done",{numFiles:i.length}),n(0,i=null)},function(){n(0,i=null),a("done",{numFiles:0})},function(e){H(t,e)},()=>n(1,++r),()=>n(1,--r)]}export default class extends t{constructor(t){super(),e(this,t,dt,ut,n,{})}}
